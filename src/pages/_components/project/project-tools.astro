---
import type { ToolKey, Tool } from "@/types";
import { Tools } from "@/config/validations/project-schema";
import InfiniteLoopSlider from "@/components/ui/Infinite-loop-slider.astro";
import { Icon } from "astro-icon/components";

const ROWS: number = 2;
const TOOLS_PER_ROW: number = 20;

interface Props {
  toolKeys: ToolKey[];
}

const { toolKeys } = Astro.props as Props;

const tools: Tool[] = toolKeys.map((toolKey) => {
  return Tools.find((tool) => tool.key === toolKey);
});
const random = (min: number, max: number) =>
  Math.floor(Math.random() * (max - min)) + min;
---

<div
  class="relative h-full flex shrink-0 flex-col gap-m items-center justify-center overflow-hidden"
>
  {
    [...new Array(ROWS)].map((row, i) => {
      return (
        <InfiniteLoopSlider
          duration={random(43000, 45000)}
          reverse={i % 2 == 0}
        >
          {tools.slice(0, TOOLS_PER_ROW).map((tool) => (
            <div
              aria-label={tool.name}
              title={tool.name}
              class="p-s rounded-xl bg-bgColor ml-xs z-10 shadow-2xl "
            >
              <Icon name={tool.icon} class="size-10   " />
            </div>
          ))}
        </InfiniteLoopSlider>
      );
    })
  }

  <!-- <div class="fade"></div> -->
</div>

<style>
  .fade {
    pointer-events: none;
    background: linear-gradient(
      90deg,
      oklch(14.48% 0 0),
      transparent 10%,
      transparent 90%,
      oklch(14.48% 0 0)
    );
    position: absolute;
    inset: 0;
  }
</style>
